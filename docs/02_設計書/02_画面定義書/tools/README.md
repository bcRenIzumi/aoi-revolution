# Excel to Markdown コンバーター

このディレクトリには、Excelファイルから画面項目一覧のMarkdownファイルを生成するためのツールが含まれています。

## 概要

`excel_to_md_converter.py`は、Excelファイルの「画面項目」シートから情報を読み込み、プロセスNoごとにグルーピングして、各プロセス用の画面項目一覧Markdownファイルを自動生成します。

## ファイル構成

```
tools/
├── README.md                                               # このファイル
├── excel_to_md_converter.py                               # 変換スクリプト
├── templete_画面項目一覧.md                              # テンプレートファイル
└── 【共通申請】プロセス修正ヒアリングシート_インフラソリューション部.xlsx  # 対象Excelファイル
```

## 前提条件

- Python 3.x
- pandas ライブラリ
- openpyxl ライブラリ（Excel読み込み用）

### ライブラリのインストール

```bash
pip install pandas openpyxl
```

## 使用方法

### 1. 基本的な使用方法

```bash
python excel_to_md_converter.py
```

デフォルトでは、同じディレクトリ内の`【共通申請】プロセス修正ヒアリングシート_インフラソリューション部.xlsx`ファイルを対象とします。


### 2. カスタム実行

スクリプトを直接編集して、異なるExcelファイルやシート名を指定できます：

```python
# __main__ セクションを編集
excel_file_path = "your_excel_file.xlsx"
sheet_name = "your_sheet_name"  # デフォルト: '画面項目'
```

### 3. 関数として使用

```python
from excel_to_md_converter import excel_to_md_converter

# カスタムファイルとシート名で実行
excel_to_md_converter("your_file.xlsx", "your_sheet")
```

## 出力ファイル

各プロセスNoに対して、以下の形式でMarkdownファイルが生成されます：

- ファイル名: `{プロセスNo}_画面項目一覧.md`
- 例: `ID_0001_画面項目一覧.md`

## 生成されるMarkdownファイルの構造

```markdown
# {プロセス名}画面 項目一覧
|日付|更新者|更新内容|
|---|---|---|
|2024/01/01|BC大島谷|新規作成|

## 基本情報
|プロセスNo|プロセス名（申請名）|フローパタン|
|---|---|---|
| ID_0001 | 申請基本情報 | 標準 |

## 項目
|項目名|項目ID|必須|型|...|
|---|---|---|---|---|
|申請者名|applicantName|○|文字列|...|
...
```

## Excelファイルの想定形式

スクリプトは以下の形式のExcelファイルを想定しています：

- **シート名**: 「画面項目」（変更可能）
- **B列**: プロセスNo
- **C列**: プロセス名（申請名）
- **D列**: フローパタン
- **E～Q列**: 項目の詳細情報（項目名、ID、必須、型など）

## 注意事項

1. **ヘッダー行**: 2行目（1-indexed）をヘッダーとして扱います
2. **データ行**: 3行目以降をデータとして処理します
3. **空のプロセスNo**: プロセスNoが空の行はスキップされます
4. **ファイル名**: プロセスNoに`/`や`\`が含まれる場合、`_`に置換されます

## トラブルシューティング

### エラー: ファイルが見つからない
```
エラー: ファイル 'xxx.xlsx' が見つかりません。
```
- ファイルパスが正しいか確認してください
- ファイルが同じディレクトリにあるか確認してください

### エラー: シートが見つからない
```
エラー: シート 'xxx' が見つかりません。
```
- シート名が正しいか確認してください
- Excelファイルに指定したシートが存在するか確認してください

### エラー: pandasまたはopenpyxlが見つからない
```
ModuleNotFoundError: No module named 'pandas'
```
- 必要なライブラリをインストールしてください：`pip install pandas openpyxl`

## 更新履歴

|日付|更新者|更新内容|
|---|---|---|
|2025/07/07|BC大島谷|初版作成|
